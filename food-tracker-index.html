<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <div id="app"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const initialFoodsData = [
            { name: 'Nayosa Extra Firm Tofu', servingSize: 85, calories: 70, protein: 8, carbs: 2, fat: 4 },
            { name: 'Paneer', servingSize: 28, calories: 90, protein: 7, carbs: 1, fat: 7 },
            { name: 'Protein Shake', servingSize: 33, calories: 120, protein: 25, carbs: 4, fat: 1 },
            { name: 'Premier Protein Cereal', servingSize: 42, calories: 180, protein: 20, carbs: 14, fat: 5 },
            { name: 'Roti', servingSize: 1, calories: 78, protein: 2.4, carbs: 13.8, fat: 2.1 },
            { name: 'Oil', servingSize: 15, calories: 120, protein: 0, carbs: 0, fat: 14 },
            { name: 'Oat Milk', servingSize: 240, calories: 80, protein: 1, carbs: 1, fat: 2.5 },
            { name: 'Chia Seeds', servingSize: 30, calories: 150, protein: 5, carbs: 0, fat: 0 },
            { name: 'Greek Yogurt', servingSize: 170, calories: 90, protein: 18, carbs: 5, fat: 0 },
            { name: 'Protein Bar', servingSize: 1, calories: 190, protein: 16, carbs: 14, fat: 8 },
            { name: 'Poha', servingSize: 25, calories: 104, protein: 1.5, carbs: 21, fat: 1 },
            { name: 'Peanuts', servingSize: 1, calories: 5.9, protein: 0.2, carbs: 0.2, fat: 0.5 },
            { name: 'Nuts (Almonds, Cashews, Pecans)', servingSize: 28, calories: 170, protein: 5, carbs: 7, fat: 15 },
            { name: 'Dal', servingSize: 51, calories: 170, protein: 13, carbs: 31, fat: 0.5 },
            { name: 'Dates', servingSize: 40, calories: 110, protein: 1, carbs: 30, fat: 0 },
            { name: 'Rice', servingSize: 45, calories: 180, protein: 3, carbs: 42, fat: 0 },
            { name: 'Sabzi', servingSize: 100, calories: 100, protein: 0, carbs: 0, fat: 0 },
            { name: 'Peanut Butter', servingSize: 33, calories: 190, protein: 7, carbs: 8, fat: 16 },
            { name: 'Bread', servingSize: 40, calories: 110, protein: 3, carbs: 21, fat: 2 },
            { name: 'Soya Chunks', servingSize: 15, calories: 50, protein: 7, carbs: 5, fat: 0 },
            { name: 'Pasta', servingSize: 56, calories: 200, protein: 7, carbs: 42, fat: 1 },
            { name: 'Besan', servingSize: 100, calories: 387, protein: 22, carbs: 58, fat: 7 },
            { name: 'Protein Chips', servingSize: 1, calories: 140, protein: 19, carbs: 5, fat: 5 },
            { name: 'Angel hair pasta', servingSize: 56, calories: 200, protein: 7, carbs: 42, fat: 1 },
            { name: 'Vegan Sausage', servingSize: 1, calories: 240, protein: 27, carbs: 10, fat: 10 },
            { name: 'Kala Chana', servingSize: 35, calories: 127, protein: 7, carbs: 21, fat: 2 },
            { name: 'Black eyed peas', servingSize: 35, calories: 90, protein: 3, carbs: 19, fat: 0 },
            { name: 'Semolina Rava', servingSize: 40, calories: 140, protein: 5, carbs: 29, fat: 0 },
            { name: 'Oats', servingSize: 50, calories: 190, protein: 6, carbs: 34, fat: 3.5 },
            { name: 'Grapes', servingSize: 100, calories: 70, protein: 0, carbs: 0, fat: 0 },
            { name: 'Honeydew', servingSize: 100, calories: 36, protein: 0.5, carbs: 9.1, fat: 0.1 },
            { name: 'Chocolate Chip', servingSize: 15, calories: 60, protein: 0, carbs: 0, fat: 0 },
            { name: 'Cheese', servingSize: 28, calories: 100, protein: 6, carbs: 1, fat: 8 },
            { name: 'Black Beans', servingSize: 60, calories: 120, protein: 7, carbs: 22, fat: 0.5 },
            { name: 'Taco Shells', servingSize: 2, calories: 130, protein: 2, carbs: 17, fat: 6 }
        ];

        function FoodTrackerApp() {
            const [foods, setFoods] = useState([]);
            const [dailyLog, setDailyLog] = useState([]);
            const [activeTab, setActiveTab] = useState('tracker');
            const [newFood, setNewFood] = useState({
                name: '', servingSize: '', calories: '', protein: '', carbs: '', fat: ''
            });
            const [logEntry, setLogEntry] = useState({ foodId: '', weight: '' });
            const [editingFood, setEditingFood] = useState(null);

            useEffect(() => {
                const savedFoods = localStorage.getItem('foodTrackerFoods');
                const savedLog = localStorage.getItem('foodTrackerDailyLog');
                const savedDate = localStorage.getItem('foodTrackerDate');
                const today = new Date().toDateString();

                if (savedFoods) {
                    setFoods(JSON.parse(savedFoods));
                } else {
                    const foodsWithIds = initialFoodsData.map((f, i) => ({ ...f, id: i + 1 }));
                    setFoods(foodsWithIds);
                    localStorage.setItem('foodTrackerFoods', JSON.stringify(foodsWithIds));
                }

                if (savedLog && savedDate === today) {
                    setDailyLog(JSON.parse(savedLog));
                } else {
                    setDailyLog([]);
                    localStorage.setItem('foodTrackerDate', today);
                }
            }, []);

            useEffect(() => {
                if (foods.length > 0) {
                    localStorage.setItem('foodTrackerFoods', JSON.stringify(foods));
                }
            }, [foods]);

            useEffect(() => {
                localStorage.setItem('foodTrackerDailyLog', JSON.stringify(dailyLog));
            }, [dailyLog]);

            const handleAddFood = () => {
                if (newFood.name && newFood.servingSize && newFood.calories) {
                    setFoods([...foods, {
                        id: Date.now(),
                        name: newFood.name,
                        servingSize: parseFloat(newFood.servingSize),
                        calories: parseFloat(newFood.calories),
                        protein: parseFloat(newFood.protein) || 0,
                        carbs: parseFloat(newFood.carbs) || 0,
                        fat: parseFloat(newFood.fat) || 0
                    }]);
                    setNewFood({ name: '', servingSize: '', calories: '', protein: '', carbs: '', fat: '' });
                }
            };

            const handleDeleteFood = (id) => {
                setFoods(foods.filter(f => f.id !== id));
            };

            const handleEditFood = (food) => {
                setEditingFood({...food});
            };

            const handleSaveEdit = () => {
                setFoods(foods.map(f => f.id === editingFood.id ? editingFood : f));
                setEditingFood(null);
            };

            const handleAddLog = () => {
                if (logEntry.foodId && logEntry.weight) {
                    const food = foods.find(f => f.id === parseInt(logEntry.foodId));
                    const multiplier = parseFloat(logEntry.weight) / food.servingSize;
                    
                    setDailyLog([...dailyLog, {
                        id: Date.now(),
                        foodName: food.name,
                        weight: parseFloat(logEntry.weight),
                        calories: (food.calories * multiplier).toFixed(1),
                        protein: (food.protein * multiplier).toFixed(1),
                        carbs: (food.carbs * multiplier).toFixed(1),
                        fat: (food.fat * multiplier).toFixed(1)
                    }]);
                    setLogEntry({ foodId: '', weight: '' });
                }
            };

            const handleDeleteLog = (id) => {
                setDailyLog(dailyLog.filter(l => l.id !== id));
            };

            const handleExportData = () => {
                const data = {
                    foods: foods,
                    dailyLog: dailyLog,
                    date: new Date().toDateString()
                };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'food-tracker-' + new Date().toISOString().split('T')[0] + '.json';
                a.click();
            };

            const handleImportData = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (data.foods) setFoods(data.foods);
                            if (data.dailyLog) setDailyLog(data.dailyLog);
                            alert('Data imported successfully!');
                        } catch (err) {
                            alert('Error importing data. Please check the file format.');
                        }
                    };
                    reader.readAsText(file);
                }
            };

            const getTotals = () => {
                return dailyLog.reduce((acc, entry) => ({
                    calories: acc.calories + parseFloat(entry.calories),
                    protein: acc.protein + parseFloat(entry.protein),
                    carbs: acc.carbs + parseFloat(entry.carbs),
                    fat: acc.fat + parseFloat(entry.fat)
                }), { calories: 0, protein: 0, carbs: 0, fat: 0 });
            };

            const totals = getTotals();

            return (
                <div className="p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="flex justify-between items-center mb-6">
                            <h1 className="text-4xl font-bold text-gray-800">Food Tracker</h1>
                            <div className="flex gap-2">
                                <button onClick={handleExportData} className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 flex items-center gap-2">
                                    Export
                                </button>
                                <label className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 flex items-center gap-2 cursor-pointer">
                                    Import
                                    <input type="file" accept=".json" onChange={handleImportData} className="hidden" />
                                </label>
                            </div>
                        </div>
                        
                        <div className="flex gap-2 mb-6">
                            <button onClick={() => setActiveTab('tracker')} className={`flex-1 py-3 px-4 rounded-lg font-semibold transition ${activeTab === 'tracker' ? 'bg-green-600 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}>
                                Daily Tracker
                            </button>
                            <button onClick={() => setActiveTab('database')} className={`flex-1 py-3 px-4 rounded-lg font-semibold transition ${activeTab === 'database' ? 'bg-blue-600 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}>
                                Food Database
                            </button>
                        </div>

                        {activeTab === 'tracker' && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Today's Summary</h2>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        <div className="bg-red-50 p-4 rounded-lg">
                                            <p className="text-sm text-gray-600">Calories</p>
                                            <p className="text-2xl font-bold text-red-600">{totals.calories.toFixed(0)}</p>
                                        </div>
                                        <div className="bg-blue-50 p-4 rounded-lg">
                                            <p className="text-sm text-gray-600">Protein (g)</p>
                                            <p className="text-2xl font-bold text-blue-600">{totals.protein.toFixed(1)}</p>
                                        </div>
                                        <div className="bg-yellow-50 p-4 rounded-lg">
                                            <p className="text-sm text-gray-600">Carbs (g)</p>
                                            <p className="text-2xl font-bold text-yellow-600">{totals.carbs.toFixed(1)}</p>
                                        </div>
                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <p className="text-sm text-gray-600">Fat (g)</p>
                                            <p className="text-2xl font-bold text-purple-600">{totals.fat.toFixed(1)}</p>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-xl font-bold text-gray-800 mb-4">Log Food</h2>
                                    <div className="flex flex-col md:flex-row gap-4">
                                        <select value={logEntry.foodId} onChange={(e) => setLogEntry({...logEntry, foodId: e.target.value})} className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                                            <option value="">Select a food</option>
                                            {foods.map(food => (
                                                <option key={food.id} value={food.id}>{food.name} ({food.servingSize}g)</option>
                                            ))}
                                        </select>
                                        <input type="number" step="0.1" placeholder="Weight (g)" value={logEntry.weight} onChange={(e) => setLogEntry({...logEntry, weight: e.target.value})} className="w-full md:w-40 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" />
                                        <button onClick={handleAddLog} className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">Add</button>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-xl font-bold text-gray-800 mb-4">Today's Log</h2>
                                    {dailyLog.length === 0 ? (
                                        <p className="text-gray-500 text-center py-8">No entries yet. Start logging your meals!</p>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full">
                                                <thead className="bg-gray-50">
                                                    <tr>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Food</th>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Weight (g)</th>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Calories</th>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Protein (g)</th>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Carbs (g)</th>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Fat (g)</th>
                                                        <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y divide-gray-200">
                                                    {dailyLog.map(entry => (
                                                        <tr key={entry.id} className="hover:bg-gray-50">
                                                            <td className="px-4 py-3">{entry.foodName}</td>
                                                            <td className="px-4 py-3">{entry.weight}</td>
                                                            <td className="px-4 py-3">{entry.calories}</td>
                                                            <td className="px-4 py-3">{entry.protein}</td>
                                                            <td className="px-4 py-3">{entry.carbs}</td>
                                                            <td className="px-4 py-3">{entry.fat}</td>
                                                            <td className="px-4 py-3">
                                                                <button onClick={() => handleDeleteLog(entry.id)} className="text-red-600 hover:text-red-800">Delete</button>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {activeTab === 'database' && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-xl font-bold text-gray-800 mb-4">Add New Food</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <input type="text" placeholder="Food Name" value={newFood.name} onChange={(e) => setNewFood({...newFood, name: e.target.value})} className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" />
                                        <input type="number" step="0.1" placeholder="Serving Size (g)" value={newFood.servingSize} onChange={(e) => setNewFood({...newFood, servingSize: e.target.value})} className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" />
                                        <input type="number" step="0.1" placeholder="Calories" value={newFood.calories} onChange={(e) => setNewFood({...newFood, calories: e.target.value})} className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" />
                                        <input type="number" step="0.1" placeholder="Protein (g)" value={newFood.protein} onChange={(e) => setNewFood({...newFood, protein: e.target.value})} className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" />
                                        <input type="number" step="0.1" placeholder="Carbs (g)" value={newFood.carbs} onChange={(e) => setNewFood({...newFood, carbs: e.target.value})} className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" />
                                        <input type="number" step="0.1" placeholder="Fat (g)" value={newFood.fat} onChange={(e) => setNewFood({...newFood, fat: e.target.value})} className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" />
                                        <button onClick={handleAddFood} className="md:col-span-3 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Add Food</button>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-xl font-bold text-gray-800 mb-4">Your Food Database ({foods.length} items)</h2>
                                    <div className="overflow-x-auto max-h-96 overflow-y-auto">
                                        <table className="w-full">
                                            <thead className="bg-gray-50 sticky top-0">
                                                <tr>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Food</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Serving (g)</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Calories</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Protein</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Carbs</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Fat</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-600">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-200">
                                                {foods.map(food => (
                                                    <tr key={food.id} className="hover:bg-gray-50">
                                                        {editingFood && editingFood.id === food.id ? (
                                                            <>
                                                                <td className="px-4 py-3"><input type="text" value={editingFood.name} onChange={(e) => setEditingFood({...editingFood, name: e.target.value})} className="w-full px-2 py-1 border rounded" /></td>
                                                                <td className="px-4 py-3"><input type="number" step="0.1" value={editingFood.servingSize} onChange={(e) => setEditingFood({...editingFood, servingSize: parseFloat(e.target.value)})} className="w-full px-2 py-1 border rounded" /></td>
                                                                <td className="px-4 py-3"><input type="number" step="0.1" value={editingFood.calories} onChange={(e) => setEditingFood({...editingFood, calories: parseFloat(e.target.value)})} className="w-full px-2 py-1 border rounded" /></td>
                                                                <td className="px-4 py-3"><input type="number" step="0.1" value={editingFood.protein} onChange={(e) => setEditingFood({...editingFood, protein: parseFloat(e.target.value)})} className="w-full px-2 py-1 border rounded" /></td>
                                                                <td className="px-4 py-3"><input type="number" step="0.1" value={editingFood.carbs} onChange={(e) => setEditingFood({...editingFood, carbs: parseFloat(e.target.value)})} className="w-full px-2 py-1 border rounded" /></td>
                                                                <td className="px-4 py-3"><input type="number" step="0.1" value={editingFood.fat} onChange={(e) => setEditingFood({...editingFood, fat: parseFloat(e.target.value)})} className="w-full px-2 py-1 border rounded" /></td>
                                                                <td className="px-4 py-3">
                                                                    <button onClick={handleSaveEdit} className="text-green-600 hover:text-green-800 mr-2">Save</button>
                                                                    <button onClick={() => setEditingFood(null)} className="text-gray-600 hover:text-gray-800">Cancel</button>
                                                                </td>
                                                            </>
                                                        ) : (
                                                            <>
                                                                <td className="px-4 py-3 font-medium">{food.name}</td>
                                                                <td className="px-4 py-3">{food.servingSize}</td>
                                                                <td className="px-4 py-3">{food.calories}</td>
                                                                <td className="px-4 py-3">{food.protein}</td>
                                                                <td className="px-4 py-3">{food.carbs}</td>
                                                                <td className="px-4 py-3">{food.fat}</td>
                                                                <td className="px-4 py-3">
                                                                    <button onClick={() => handleEditFood(food)} className="text-blue-600 hover:text-blue-800 mr-2">Edit</button>
                                                                    <button onClick={() => handleDeleteFood(food.id)} className="text-red-600 hover:text-red-800">Delete</button>
                                                                </td>
                                                            </>
                                                        )}
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<FoodTrackerApp />, document.getElementById('app'));
    </script>
</body>
</html>